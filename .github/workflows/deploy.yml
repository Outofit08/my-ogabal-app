name: Deploy to Bluehost
on:
  push:
    branches: [ "master" ]

jobs:
  web-deploy:
    name: Deploy
    runs-on: ubuntu-latest
    
    steps:
    - name: Get latest code
      uses: actions/checkout@v4
    
    - name: Use Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'
        
    - name: Clean Install Dependencies
      run: npm ci
        
    - name: Build Project
      run: npm run build
        
    - name: Prepare for deployment
      run: |
        cp .htaccess build/
        
    - name: Deploy to Server
      uses: easingthemes/ssh-deploy@v5.0.0
      with:
        REMOTE_HOST: ${{ secrets.SSH_HOST }}
        REMOTE_USER: ${{ secrets.SSH_USERNAME }}
        SOURCE: "build/"
        TARGET: "/home/${{ secrets.SSH_USERNAME }}/public_html/"
        ARGS: "-rltgoDzvO" 